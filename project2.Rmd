---
title: "Project 2"
---

```{r setup, include=FALSE}
library(tidyverse)
knitr::opts_chunk$set(echo = TRUE)
```

This is the dataset you will be working with:
```{r message = FALSE}
olympics <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2021/2021-07-27/olympics.csv')

olympic_gymnasts <- olympics %>% 
  filter(!is.na(age)) %>%             # only keep athletes with known age
  filter(sport == "Gymnastics") %>%   # keep only gymnasts
  mutate(
    medalist = case_when(             # add column for success in medaling
      is.na(medal) ~ FALSE,           # NA values go to FALSE
      !is.na(medal) ~ TRUE            # non-NA values (Gold, Silver, Bronze) go to TRUE
    )
  )
head(olympic_gymnasts)
```

More information about the dataset can be found at https://github.com/rfordatascience/tidytuesday/tree/master/data/2021/2021-07-27/readme.md and https://www.sports-reference.com/olympics.html.

**Question:** Are there age differences for male and female Olympic gymnasts who were successful or not in earning a medal, and how has the age distribution changed over the years? 

We recommend you use a violin plot for the first part of the question and faceted boxplots for the second question part of the question. 


**Hints:**

- To make a series of boxplots over time, you will have add the following to your `aes()` statement: `group = year`. 
- It can be a bit tricky to re-label facets generated with `facet_wrap()`. The trick is to add a `labeller` argument, for example:
```r
 + facet_wrap(
    # your other arguments to facet_wrap() go here
    ...,
    # this replaces "TRUE" with "medaled" and "FALSE" with "did not medal"
    labeller = as_labeller(c(`TRUE` = "medaled", `FALSE` = "did not medal"))
  )
```

**Introduction:** We are working with the 'olympic_gymnasts' dataset which contains 25528 records of Olympic gymnasts and medal results for all Games from Athens 1896 to Rio 2016. In this dataset each row correspond to one Olympic gymnasts and there are 16 columns providing information about the gymnast, the events, and the Games. Data on competing gymnasts include their unique ID, name, sex, age, height, weight, country/team and their National Olympic Committee region. Further information is provided on the events each gymnast competed in, including the sport, the specific event, and the medal results. Information about each Olympic Game includes its game name, the year it was held, its season,and its host city.

To answer the questions (Are there age differences for male and female Olympic gymnasts who were successful or not in earning a medal, and how has the age distribution changed over the years? ), we'll work with four variables,the competing gymnast's age(column 'age'), sex(column 'sex'), the year of the Olympic Game held(column 'games'), and whether the gymnast got a medal or not(column 'medalist'). The athlete's age is provided as numeric values, and the game year is provided as discrete variable. The gymnast's sex was encoded as F/M representing Female and Male respectively. Whether the gymnast won a medal or not is recorded as 'TRUE' or 'FALSE', where 'TRUE means the gymnast won medal and 'FALSE' means no medal.

**Approach:** Our approach is to show the distributions of gymnasts' age versus sex violin plots (`geom_violin()`). We also separate out gymnasts who were successful or not in earning a medal using color mapping to show whether this two group have age difference. Violins make it easy to compare multiple distributions side-by-side.

One limitation of the violin plots is that they don't show us how has the age distribution changed over the years. Therefore, we'll visualize the age of gymnasts and the games/year of the Olympic Game held with boxplot (`geom_boxplot()`). Jointly, these two plots will allow us to answer the question.


**Analysis:** First we plot the gymnast's age distribution as violins.

```{r }
ggplot(olympic_gymnasts,aes(sex, age, fill = medalist))+
  geom_violin()+
  scale_x_discrete(
    name = '',
    labels = c('Female','Male')
  )+
  scale_y_continuous(
    name = 'Age'
  )+
  scale_fill_discrete(
    name = NULL,
    labels = c('did not medal', 'medaled')
  )+
  ggtitle("Gymnast's age distribution")+
  theme_bw(12)
  
```



Then we plot the age distribution over the years(using the column 'games' which is a discrete variable) as boxplot. We color mapped the sex as it showed from violin plot that the gymnast's age has difference between two sex groups. And we facet by whether the gymnast is successful or not in earning a medal so we can clearly see whether there is any relationship between age and medal-winning.


```{r }
q<-ggplot(olympic_gymnasts, aes(games, age, fill=sex))+
  geom_boxplot()+
  scale_x_discrete(name = '')+
  scale_fill_discrete(name = '',labels = c('Female','Male'))+
  facet_wrap(~ medalist, 
             nrow = 2,
             # use `as_labeller` to rename the labels
             labeller = as_labeller(c(`TRUE` = "Medaled", `FALSE` = "Did not medal"))
             )
# rotate x axis labels to be vertical
q+theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
  ggtitle("Gymnast's age distribution change over the years")
  

```


**Discussion:**  For female gymnasts, the age has little effect on whether they win a medal or not, similar results can be observed in male gymnasts. However the overall age differs a lot from female to male gymnast, we can see this by comparing the green violin(medal winning gymnast) in the first plot, where we see that they are significantly shifted relative to each other but have otherwise a comparable shape. And the red violin (no medal gymnast) is in the same case. Female gymnasts are on average much younger than male gymnasts but the variance does not have much difference. We would have to run a multivariate statistical analysis to determine whether any of these observed patterns are statistically significant.

When we look at the gymnast's age distribution change over the years boxplot, we see that the female were not able to compete in Olympics until 1926-1928, and they are on average at their mid-20s when competed in the games during 1930-1964. Then the age of competing female gymnasts tended to skew younger,the 1968 Olympics witnessed the steepest decline in average age of a gymnast, the 1980-1984 Olympics have some of the lowest ages(younger than 15 years old), until recent years it started to bounce back a little. This trend is more obvious with the medaled group. For the male gymnast, we can observe similar age distribution change over the years but the trend is flatter than female  and also the age of male gymnast is overall older than female gymnast which is consistent with the violin plot.

Why the data tend to be like what it is? First we can conclude that in general the average age of male gymnast is older than the female gymnast. My speculation is that the male and female are different physically, besides male and female gymnastics has different emphasis (power / strength / flexibility /twist,etc). The age change over the years is more complicated, it involves many 'influences', such as the impact of world war II, 1980 and 1984 Olympics boycott, the success of younger gymnasts, the Olympic athlete age limits, the scoring criteria  and so on.